---
# tasks file for worker_delft3d

  - name: create docker directory
    file: path=/data/container state=directory recurse=yes owner=docker
    become: yes

  - name: copy Dockerfile
    copy: src=Dockerfile dest=/data/container
    become: yes
    become_method: sudo
    become_user: docker

  - name: copy delft3d rpm
    copy: src={{ delft3d_rpm }} dest=/data/container
    become: yes
    become_method: sudo
    become_user: docker

  - name: start docker
    service: name=docker state=started
    become: yes
    become_method: sudo

  - name: build delft3d docker image
    command: docker build -t delft3d /data/container
    become: yes
    become_method: sudo

  - name: Copy testrun Delft3d
    copy: src={{ test_calculation_local }} dest={{ test_calculation_host}} owner=docker group=docker mode=0744
    become: yes
    become_method: sudo
    become_user: docker

# Use the following command to start the container in the provisioned machine:
# docker run -v /data/container/01_standard:/data delft3d